# Проект: Биометрическая идентификация с использованием DeepFace

## Описание
Этот проект посвящён оценке точности методов биометрической идентификации на основе DeepFace. В процессе работы был проведён анализ точности face verification (сравнение один-к-одному), а также обработка видео и изображений с применением различных аугментаций.

## Структура проекта
```
.lab4/                      # Виртуальное окружение (игнорируется гитом)
.vscode/                    # Настройки VS Code
hse_faces_miem/             # Набор фотографий (удалён из истории Git)
.gitignore                  # Файл для исключения ненужных файлов из Git
emb.py                      # Скрипт для генерации эмбеддингов
emb_i.py                    # Вспомогательный скрипт для работы с эмбеддингами
embeddings.npy              # Сохранённые эмбеддинги лиц (игнорируется Git)
face_detection.py           # Модуль для детекции лиц
face_detection_yunet_2023mar.onnx  # Предобученная модель для детекции
face_verification.py        # Код для верификации лиц
finding.py                  # Поиск лица в базе по эмбеддингам
image_index.index           # Индекс изображений (игнорируется Git)
selfie.jpg                  # Примерное изображение для тестирования
staff_photo.csv             # CSV-таблица (удалена из истории Git)
```

## Установка и настройка
1. Клонируем репозиторий:
   ```sh
   git clone https://github.com/vyumalasko/lab4.git
   cd lab4
   ```
2. Создаём виртуальное окружение и устанавливаем зависимости:
   ```sh
   python -m venv .lab4
   source .lab4/bin/activate  # Для Linux/macOS
   .lab4\Scripts\activate     # Для Windows
   pip install -r requirements.txt
   ```

## Этапы работы
### 1. Настройка среды
- Установлены библиотеки OpenCV, DeepFace, NumPy.
- Загружена предобученная модель YuNet для детекции лиц.
- Подготовлен датасет фотографий (исключён из репозитория).

### 2. Детекция лиц
- Использована модель YuNet (`face_detection_yunet_2023mar.onnx`).
- Реализован `face_detection.py`, который выделяет лица и обводит их рамками.

### 3. Генерация эмбеддингов
- `emb.py` вычисляет эмбеддинги лиц с использованием DeepFace.
- Сохранение результатов в `embeddings.npy`.

### 4. Верификация лиц
- `face_verification.py` выполняет сравнение лиц с базой эмбеддингов.
- Вычислены метрики точности (Precision, Recall).

## Как использовать
- Для поиска лица в базе:
  ```sh
  python finding.py --image selfie.jpg
  ```
- Для верификации двух лиц:
  ```sh
  python face_verification.py --img1 img1.jpg --img2 img2.jpg
  ```

## Студент
**Виктория Юрьевна Малашко**

